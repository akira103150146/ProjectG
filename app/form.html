<html>
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="css/form.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="css/sidebar.css" type="text/css" media="screen" />
    <link href="jQuery-contextMenu-master/dist/jquery.contextMenu.css" rel="stylesheet" type="text/css" />
    <script src="../node_modules/jquery/dist/jquery.min.js"></script>
    <script>
        let $ = require('jquery')
        let jQuery = require('jquery')      
    </script>
    <script type="text/javascript" src="js/lib/header.js"></script>
    <script type="text/javascript" src="js/lib/redips-table-min.js"></script>
    <script type="text/javascript" src="js/lib/script.js"></script>
    <script src="jQuery-contextMenu-master/dist/jquery.contextMenu.js" type="text/javascript"></script>
    <script>
        var ipcrender = require('electron').ipcRenderer
        ipcrender.on('reply-form',function (event, arg){      
            redips.showlist(arg)
        })
        ipcrender.on('update-form',function(event, content,tag){
            redips.updateform(content,tag)
        })
        ipcrender.on('bind_devices', function (event, arg) {
                console.log(arg.toString())

        })
        $(document).ready(function () {
            ipcrender.send('ready-to-show', 'form')
            $('#bagi').on('click', () => {
                ipcrender.send('switch_page', 0)
            })
            $('#setting').on('click', () => {
                ipcrender.send('switch_page', 1)
            })
            $('#form').on('click', () => {
                ipcrender.send('switch_page', 2)
            })
            $('#member').on('click', () => {
                ipcrender.send('switch_page', 3)
            })
            $('#info').on('click', () => {
                ipcrender.send('switch_page', 4)
            })
             $('#post').on('click', () => {
                ipcrender.send('switch_page', 5)
            })
            $('#histroy').on('click', () => {
                ipcrender.send('switch_page', 6)
            })
            $('#assign').on('click', () => {
                ipcrender.send('switch_page', 7)
            })
            $('#sidebarCollapse').on('click', function () {
                $('#sidebar').toggleClass('active');
            });
            $('#close_btn').on('click', () => {
                $('#sidebar').toggleClass('active');
            })
            $('#logout_btn').click(function () {
                ipcrender.send('logout')
            })
        });
        
        $(function () {
            $('#mainTable').contextMenu({
                selector: 'td',
                items: {
                    "SetToNotChangeAble": {
                        name: "設為不可填", icon: "edit", callback: function () {
                            $(this)[0].contentEditable = false;
                        }
                    },
                    "SetToChangeAble": {
                        name: "設為可填", icon: "edit", callback: function () {
                            $(this)[0].contentEditable = true;
                        }
                    },
                    "add": {
                        name: "新增", icon: "paste",
                        items: {
                            "checkbox": {
                                name: "勾選格", callback: function () {
                                    let i = document.createElement('INPUT');
                                    i.setAttribute("type", "checkbox");
                                    $(this).append(i);
                                }
                            },
                            "image": {
                                name: "圖片上傳", callback: function () {
                                    let i = document.createElement('INPUT');
                                    i.setAttribute("type", "file");
                                    $(this).append(i);
                                }
                            }
                        }
                    },
                    "delete": { name: "Delete", icon: "delete" },
                    "sep1": "---------",
                    "quit": { name: "Quit", icon: function ($element, key, item) { return 'context-menu-icon context-menu-icon-quit'; } }
                }
            });
        });
    </script>
  
</head>

<body>
    <div class="wrapper">
        <nav id="sidebar">
            <div class="sidebar-header">
                <h3 id="close_btn">Close &times;</h3>
                <h3 id="user-name">AKIRA</h3>
                <button id="logout_btn">登出</button>
            </div>
            <ul>
            <li>
                <a id="post">公佈欄</a>
            </li>
            <li class="active">
                <a id="form">巡檢表單編輯</a>
            </li>
            <li>
                <a id="setting">巡檢設備設定</a>
            </li>
            <li>
                <a id="bagi">巡檢任務派遣</a>
            </li>
            <li>
                <a id="assign">巡檢排程設定</a>
            </li>
            <li>
                <a id="info">維修主配件庫存查詢</a>
            </li>
            <li>
                <a id="history">運維歷史表單查詢</a>
            </li>
            <li>
                <a id="member">巡檢人員帳戶設定</a>
            </li>
            </ul>
        </nav>
        <div id="myContainer">
            <button type="button" id="sidebarCollapse" class="btn btn-info navbar-btn">
                <i class="glyphicon glyphicon-align-left"></i>
                ☰
            </button>

            <div class="scroll-menu">
                <ul id="form-list">
                </ul>
            </div>

            <table id="toolbox">
                <tbody>
                    <tr>
                        <td>
                            <input type="button" value="合併儲存格" class="button" onclick="redips.merge()" title="Merge marked table cells horizontally and verically"
                            />
                        </td>
                        <td>
                            <input type="button" value="水平分割儲存格" class="button" onclick="redips.split('h')" title="Split marked table cell horizontally"
                            />
                            <input type="button" value="垂直分割儲存格" class="button" onclick="redips.split('v')" title="Split marked table cell vertically"
                            />
                        </td>
                        <td>
                            <input type="button" value="新增列" class="button" onclick="redips.row('insert')" title="Add table row" />
                            <input type="button" value="刪除列" class="button" onclick="redips.row('delete')" title="Delete table row" />
                        </td>
                        <td>
                            <input type="button" value="新增行" class="button" onclick="redips.column('insert')" title="Add table column" />
                            <input type="button" value="刪除行" class="button" onclick="redips.column('delete')" title="Delete table column" />
                        </td>
                        <td>
                            <input type="button" value="新增表格" class="button" onclick="redips.addform()" title="Add Form" />
                            <input type="button" value="儲存表格" class="button" onclick="redips.saveform()" title="Save change" />
                            <input type="button" value="刪除表格" class="button" onclick="redips.removeform()" title="Remove Form" />
                        </td>
                        <td>
                            <input type="button" value="綁定表單" class="button" onclick="redips.bind_device()" title="Remove Form" />
                        </td>
                    </tr>
                </tbody>
            </table>
            <div class="form_attribute">
                ID
                <input type="text" id="ID" value="" disabled /> 
                標題
                <input type="text" id="title" value="" /> 
                創建日期
                <input type="text" id="date" value="" disabled />
            </div>
            <table id="mainTable">
                <tbody>
                    <tr>
                        <td contenteditable="true"></td>
                        <td contenteditable="true"></td>
                        <td contenteditable="true"></td>
                        <td contenteditable="true"></td>
                        <td contenteditable="true"></td>
                        <td contenteditable="true"></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</body>

</html>